[TOC]

## ECMA6学习笔记

### let和const命令

1. 使用let和const不存在变量提升。
2. 暂存性死区：使用let和const声明的变量，在声明前不能使用。变量声明前的空间称为“死区”。这样typeof也不会是绝对安全的函数了，死区内使用会报引用错误。
3. let和const变量不允许重复声明。
4. 内层作用域可以定义外层作用域变量。块级作用域的出现，实际上使得获得广泛应用的立即执行函数表达式（IIFE）不再必要了。
5. ES5中函数作用域只能在顶层作用域和函数作用域中声明，浏览器为了兼容老版本没有遵守这个规范，声明将会被提前。而在ES6中，声明会存在块级作用域中，不会被提前。
6. const在声明时候就得赋值，不然会报错。当赋给对象时候，不可指向别的对象，但是对象的值是可以变的。

### 变量的解构赋值

ES6 允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）。

1. 可以从数组或对象中提取值，按照对应位置，对变量赋值。 `let [a, b, c] = [1, 2, 3];`
2. 解构赋值允许指定默认值 `let [foo = true] = [];` 如果默认值是表达式，则是惰性求值的，只有取不到值的时候才会运行默认表达式
3. 解构的作用：
3.1 交换变量的值`[x, y] = [y, x]`
3.2 从函数返回多个值`let { foo, bar } = example();`
3.3 函数参数的定义`function f({x, y, z}) { ... }`
3.4 提取JSON对象中的数据
3.5 函数参数的默认值

### 字符串的扩展

1. 字符串遍历使用`for...of`,也可以用于遍历数组的值(`for...in`只能遍历数组的index)
2. includes(), startsWith(), endsWith()分别用来寻找参数字符串是否在源字符串中，在头部，在尾部
3. repeat方法返回一个新字符串，表示将原字符串重复n次。
4. 字符串补全长度的功能。如果某个字符串不够指定长度，会在头部或尾部补全。padStart()用于头部补全，padEnd()用于尾部补全。`'x'.padStart(4, 'ab') // 'abax'`
5. 模板字符串使用\` \`包裹，变量使用`$()`包裹

### 数组的扩展

1. Array.of方法用于将一组值，转换为数组。
2. 数组实例的find方法，用于找出第一个符合条件的数组成员。`[1, 4, -5, 10].find((n) => n < 0)`
3. fill方法使用给定值，填充一个数组。`Array.fill(num, start, end)`
4. 数组也可以用includes()方法来检查是否包含某个元素

### 函数的扩展

1. 函数参数的默认值`function log(x, y = 'World')`
2. ES6 引入 rest 参数（形式为“...变量名”），用于获取函数的多余参数，这样就不需要使用arguments对象了`function add(...values){}`
3. 扩展运算符（spread）是三个点（...）。它好比 rest 参数的逆运算，将一个数组转为用逗号分隔的参数序列。求数组中元素最大值：`Math.max(...[14, 3, 77])`
4. 函数有name属性，返回函数的名字
5. 箭头函数`var f = v => v;`等价于 `var f = function(v) {return v;};` 如果箭头函数不需要参数或需要多个参数，就使用一个圆括号代表参数部分。如果箭头函数的代码块部分多于一条语句，就要使用大括号将它们括起来，并且使用return语句返回。由于大括号被解释为代码块，所以如果箭头函数直接返回一个对象，必须在对象外面加上括号。
6. 箭头函数内的this对象只有一种指向，就是定义箭头函数时包含它的函数所在的this,如果没有就是全局变量。
7. 函数绑定运算符是并排的两个双冒号（::），双冒号左边是一个对象，右边是一个函数。该运算符会自动将左边的对象，作为上下文环境（即this对象），绑定到右边的函数上面。
8. 尾递归优化：最后一步只调用本身，这样函数的运行只会保存一个调用帧，不会发生栈溢出。
```
function factorial(n, total = 1) {
  if (n === 1) return total;
  return factorial(n - 1, n * total);
}

factorial(5) // 120
```

### 对象的扩展

1. ES6允许直接写入变量和函数，作为对象的属性和方法。`var baz = {foo};`等同于`var baz = {foo: foo};`
2. Object.assign方法用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象（target）。Object.assign方法的第一个参数是目标对象，后面的参数都是源对象。该方法是浅拷贝。

### 模块Module

1. ES6模块通过export和import实现
2. import命令具有代码提升效果
3. `import * as a from './test.js'`
4. 如果模块用了`export default`方法，则在被引用时候可以直接使用`import name from './test.js'`

### Promise对象

1. Promise 是异步编程的一种解决方案。
```
var promise = new Promise(function(resolve, reject) {
  // ... some code

  if (/* 异步操作成功 */){
    resolve(value);
  } else {
    reject(error);
  }
});
```